---
- name: Install kube-prometheus-stack via Helm
  kubernetes.core.helm:
    name: kube-prometheus-stack
    chart_ref: oci://ghcr.io/prometheus-community/charts/kube-prometheus-stack
    namespace: monitoring
    create_namespace: true
    state: present
    values_files:
      - roles/monitoring/files/kube-prometheus-values.yaml
  become: no

- name: Display monitoring status
  debug:
    msg:
      - "kube-prometheus-stack installed successfully"
      - "GPU metrics (DCGM) are managed by the GPU Operator"
      - "Prometheus will automatically scrape GPU metrics via ServiceMonitor"