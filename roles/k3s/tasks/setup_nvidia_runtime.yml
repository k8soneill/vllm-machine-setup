- name: Create NVIDIA RuntimeClass
  kubernetes.core.k8s:
    state: present
    kubeconfig: "/home/{{ ansible_user }}/.kube/config"
    definition:
      apiVersion: node.k8s.io/v1
      kind: RuntimeClass
      metadata:
        name: nvidia
      handler: nvidia
  register: nvidia_runtime_class

- name: Display RuntimeClass status
  debug:
    msg: "NVIDIA RuntimeClass {{ 'created' if nvidia_runtime_class.changed else 'already exists' }}"

- name: Verify RuntimeClass is available
  kubernetes.core.k8s_info:
    kind: RuntimeClass
    name: nvidia
    kubeconfig: "/home/{{ ansible_user }}/.kube/config"
  register: runtime_class_check
